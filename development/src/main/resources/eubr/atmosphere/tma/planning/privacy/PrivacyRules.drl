package eubr.atmosphere.tma.planning
 
dialect "mvel"

import eubr.atmosphere.tma.planning.AdaptationManager
import eubr.atmosphere.tma.data.Action
import eubr.atmosphere.tma.data.Configuration
import eubr.atmosphere.tma.utils.PrivacyScore

declare TrustworthinessScore
      @role(event)
      @expires(1s)
      //@timestamp (eventDestinationTimestamp)
 end

rule "Privacy Score Validation - Increase PRIVAAS Anonymization"
    when
        $score: PrivacyScore ( score < threshold )
    then
        AdaptationManager.increasePRIVAASAnonymization( $score );
end

rule "Privacy Score Validation - Not Increase PRIVAAS Anonymization"
    when
        $score: PrivacyScore ( score >= threshold )
    then
        AdaptationManager.noIncreasePRIVAASAnonymization( $score );
end